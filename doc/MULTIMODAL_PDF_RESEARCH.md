# PDF 멀티모달 데이터(표, 그래프, 이미지) 추출 및 활용 방안 연구

## 1. 개요
현재 시스템은 텍스트 중심의 데이터만 활용하고 있으나, 원본 PDF에는 풍부한 시각 자료(표, 그래프, 삽화 등)가 포함되어 있습니다. 이를 추출하여 BigHistory AI 서비스(채팅 답변, 강의 노트)에 활용하기 위한 기술적 방안을 정리합니다.

## 2. Google Cloud 기반 솔루션 (Google Cloud Recommendation)

### A. Vertex AI Gemini 1.5/2.5 Pro (Multimodal) - **추천**
현재 프로젝트에서 이미 사용 중인 Vertex AI를 적극 활용하는 방안입니다. Gemini 모델은 **멀티모달(Multimodal)** 능력이 뛰어나 PDF 자체를 이해할 수 있습니다.

*   **기능**:
    *   PDF의 페이지를 이미지로 변환하여 모델에 입력하면, 그 안에 있는 **도표나 그래프의 의미를 해석**할 수 있습니다.
    *   단순한 "이미지 파일 추출"을 넘어, **"이미지의 맥락 이해"**에 가장 강력합니다.

### B. Vertex AI Agent Builder (Data Store Parser) - **사용자 적용 확인**
첨부해주신 스크린샷의 설정 화면은 **Vertex AI Search (Agent Builder)**의 데이터 처리(Parsing) 설정입니다. RAG 검색 엔진이 PDF를 읽을 때 어떻게 처리할지 결정하는 부분입니다.

*   **설정 의미**:
    *   **레이아웃 파서 (Layout Parser)**: PDF의 구조(제목, 본문, 표 등)를 인식합니다.
    *   **테이블/이미지 주석 (Annotations)**: 표와 이미지를 그냥 지나치지 않고 "이것은 표입니다", "이것은 이미지입니다"라고 인식합니다.
    *   **Gemini 항상 사용 (Gemini always on)**: 인식된 표나 이미지를 **Gemini 모델이 직접 읽고 설명(텍스트)**하게 만듭니다.
*   **효과**: 검색 엔진이 **"이미지 속에 있는 내용"**까지 검색할 수 있게 됩니다. (추천 설정)

---

## 3. 실질적 구현 방안 (Python Library + GCP Hybrid)

RAG 검색 엔진의 설정(위의 B)과 별개로, **사용자 화면(Front-end)에 실제 이미지 파일을 보여주기 위해서는** 별도의 추출 과정이 필요할 수 있습니다. (Search API가 원본 이미지 URL을 주지 않는 경우 대비)

### 단계별 프로세스 (Pipeline)

1.  **이미지/표 추출 (Extraction)**: Python 라이브러리 사용
    *   **PyMuPDF (fitz)**: PDF 내의 **이미지(삽화, 사진)**를 원본 화질 그대로 추출하여 저장소(Storage)에 업로드합니다.
    *   **GCS 저장**: `gs://bucket/images/book1_page5_img1.png` 형태로 저장.

2.  **분석 및 메타데이터 생성 (Understanding)**: **Vertex AI Gemini** 사용
    *   추출된 이미지가 무엇인지 분석하여 RAG 검색 시 활용할 텍스트(설명)를 생성합니다. (위의 Vertex AI Agent Builder 설정이 이 역할을 자동으로 수행해 줍니다.)

3.  **활용 (Serving)**
    *   RAG 답변이 생성될 때, 해당 내용과 관련된 **이미지 URL**을 함께 클라이언트에 전달하여 화면에 표시합니다.

## 4. 결론 및 추천
1.  **검색 성능 향상**: 보여주신 **Vertex AI Agent Builder 설정 화면**에서 `Gemini 항상 사용`을 체크하는 것은 **매우 훌륭한 설정**입니다. AI가 이미지를 "읽고 이해"하게 만듭니다.
2.  **화면 표시 (UI)**: 만약 검색 결과에 이미지가 직접 나오지 않는다면, `PyMuPDF` 등을 이용해 **이미지를 별도 파일로 추출하여 저장**하는 파이프라인(3번 항목)을 병행해야 할 수 있습니다. 우선은 Agent Builder 설정만으로 충분한지 테스트해 보시길 권장합니다.
